@page "/"
@using System.Net.Http
@using BlazorSignalRApp.Shared.Rooms
@inject HttpClient Http

<div style="flex:1;">
    <div class="container">
        <div class="row">
            <div class="col-3" />
            <div class="col-6 px-auto mt-5">
                @if (rooms != null)
                {
                    <div class="list-group text-white text-center">
                        <div class="list-group-item border-light" style="background-color:inherit;">
                            <h5>Start new</h5>
                            <div class="btn-group" role="group">
                                <a href="#" class="btn btn-outline-light">go</a>
                            </div>
                        </div>
                        @foreach (var room in rooms)
                        {
                            <div class="list-group-item border-0" style="background-color:inherit;">
                                <h5>@room.Id</h5>
                                <div class="btn-group" role="group">
                                    <a href="/@room.Id/-1" class="btn btn-outline-light">Watch</a>
                                    @foreach (var index in Enumerable.Range(0, room.PlayerCount))
                                    {
                                        <a href="/@room.Id/@index" class="btn btn-outline-light">Player @(index+1)</a>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="mt-5 alert text-light border-light" role="alert">Loading rooms...</div>
                }
            </div>
            <div class="col-3" />
        </div>
    </div>
</div>



@code {
    private GameRoomData[] rooms;

    protected override async Task OnInitializedAsync() =>
        rooms = await Http.GetFromJsonAsync<GameRoomData[]>("gamerooms");

}